<script>

var s = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!";
var ok = true;

for(var i = 0; i < 1000; i++)
{
    var s2 = encrypt(s, i);
    var s3 = decrypt(s2, i);

    if (s3 != s)
        ok = false;
    
    console.log(i, s, s2, s3);
}
console.log("OK: " + ok);


function encrypt(s, k)
{
    var s2 = "";
    
    for(var i = 0; i < s.length; i++)
    {
        var code = s.charCodeAt(i);
        var d = 0;

        if ( code >= 65 && code <= 90)
            d = 65;

        if ( code >= 97 && code <= 122 )
            d = 97;  

        if ( d != 0 )
        {
            code -= d;
            code = (code + k) % 26;
            code += d;
        }

        s2 += String.fromCharCode(code); 
    }

    return s2;
}

function decrypt(s, k)
{
    var s2 = "";
    
    for(var i = 0; i < s.length; i++)
    {
        var code = s.charCodeAt(i);
        var d = 0;

        if ( code >= 65 && code <= 90)
            d = 65;

        if ( code >= 97 && code <= 122 )
            d = 97;  
        
        if ( d != 0 )
        {
            code -= d;
            
            //code = (code + 26 - k % 26) % 26;

            code = Math.ceil( (k - code) / 26 ) * 26 + code - k;

            code += d;
        }

        s2 += String.fromCharCode(code); 
    }

    return s2;
}


</script>
