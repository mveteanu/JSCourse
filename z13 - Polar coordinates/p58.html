<script src="../libraries/p5.js"></script>
<script>

function setup()
{
    createCanvas(600, 500);
    angleMode(DEGREES);
}

function draw()
{
    background("lightblue");

    // Create a grid of magnetic needles
    for (var x = 0; x < width; x += 30)
    {
        for(var y = 0; y < height; y += 30)
        {
            displayMagneticNeedle( x, y );
        }
    }
}

function displayMagneticNeedle(rootX, rootY)
{
    var dot = getIntermediatePoint(rootX, rootY, mouseX, mouseY, 30 );

    line(rootX, rootY, dot.x, dot.y);
    ellipse(dot.x, dot.y, 5);
}


// Returns the coordinates of a point found at distance d from (x1, y1)
// on a line defined by (x1, y1) and (x2, y2)
function getIntermediatePoint(x1, y1, x2, y2, d)
{
    var angle = atan2( y2 - y1, x2 - x1 );

    var x = x1 + d * cos(angle);
    var y = y1 + d * sin(angle);
    
    return { x : x, y : y };
}

</script>
